# AI CDN Tunnel - 环境配置模板
# 复制此文件为 .env 并修改配置

# ==================== 节点类型 ====================
# 可选值: edge (边缘节点), core (核心节点), all-in-one (一体化)
NODE_TYPE=edge

# ==================== 网络配置 ====================
# 监听地址
LISTEN_QUIC=0.0.0.0:443
LISTEN_WS=0.0.0.0:8080
LISTEN_HTTP=0.0.0.0:80

# 上游转发地址（核心节点IP，多个用逗号分隔）
UPSTREAM_SERVERS=10.0.1.10:8443,10.0.1.11:8443

# ==================== LLM源站配置 ====================
# LLM服务地址（核心节点配置）
LLM_SOURCE_HOST=10.0.1.100
LLM_SOURCE_PORT=8000

# ==================== TLS配置 ====================
# TLS证书路径
TLS_CERT_PATH=/etc/gost/certs/server.crt
TLS_KEY_PATH=/etc/gost/certs/server.key

# 是否启用TLS卸载（边缘节点设为true）
TLS_OFFLOAD=true

# ==================== 高并发配置 ====================
# 最大并发连接数
MAX_CONNECTIONS=100000

# QUIC最大并发流
QUIC_MAX_STREAMS=10000

# 协程池配置
WORKER_POOL_MIN=1000
WORKER_POOL_MAX=10000

# 连接池配置
CONNECTION_POOL_MAX_IDLE=10000
CONNECTION_POOL_IDLE_TIMEOUT=90s

# ==================== SSE/流式配置 ====================
# SSE分块大小（字节）
SSE_CHUNK_SIZE=4096

# SSE缓冲大小（字节）
SSE_BUFFER_SIZE=65536

# 心跳间隔
SSE_HEARTBEAT_INTERVAL=30s

# 最大连接时间（0表示不限制）
SSE_MAX_CONNECTION_AGE=24h

# ==================== 零缓存配置 ====================
# 启用零缓存
ZERO_CACHE_ENABLED=true

# 清除的请求头（逗号分隔）
ZERO_CACHE_CLEAR_HEADERS=cache-control,pragma,if-modified-since,if-none-match

# 强制添加的响应头
ZERO_CACHE_SET_HEADERS=no-store\\ no-cache\\ must-revalidate,pragma\\ no-cache

# ==================== 限流配置 ====================
# 全局限流（请求/秒）
RATE_LIMIT_GLOBAL=50000

# 客户端限流（请求/秒）
RATE_LIMIT_CLIENT=100

# 突发流量系数
RATE_LIMIT_BURST_FACTOR=2.0

# ==================== 认证配置 ====================
# 认证类型: none, api_key, jwt
AUTH_TYPE=api_key

# API Key（多个用逗号分隔）
API_KEYS=sk-xxxx1,sk-xxxx2,sk-xxxx3

# API Key认证头名
API_KEY_HEADER=X-API-Key

# JWT密钥（用于JWT认证）
JWT_SECRET=your-jwt-secret-key

# JWT issuer
JWT_ISSUER=ai-cdn

# ==================== 监控配置 ====================
# 是否启用监控
METRICS_ENABLED=true

# 监控端口
METRICS_PORT=9090

# 监控路径
METRICS_PATH=/metrics

# 是否启用详细指标
METRICS_DETAILED=true

# ==================== API服务配置 ====================
# 是否启用API服务
API_ENABLED=true

# API服务端口
API_PORT=18080

# API认证用户名
API_USERNAME=admin

# API认证密码
API_PASSWORD=your-secure-password

# ==================== 日志配置 ====================
# 日志级别: debug, info, warn, error
LOG_LEVEL=info

# 是否输出JSON格式
LOG_JSON=false

# ==================== 地区配置 ====================
# 节点地区代码（如: hk, cn, us, sg）
REGION=hk

# 节点优先级（数字越小优先级越高）
PRIORITY=10

# 是否为入口节点
IS_ENTRY_NODE=true

# ==================== 健康检查配置 ====================
# 健康检查间隔
HEALTH_CHECK_INTERVAL=10s

# 上游服务器超时时间
UPSTREAM_TIMEOUT=5s

# ==================== 性能调优配置 ====================
# TCP快速打开
TCP_FAST_OPEN=true

# SO_REUSEPORT（需要root权限）
SO_REUSEPORT=true

# GOMAXPROCS（0表示自动）
GOMAXPROCS=0

# GC百分比
GOGC=50

# ==================== 调试配置 ====================
# 是否启用pprof
PPROF_ENABLED=false

# pprof端口
PPROF_PORT=6060
